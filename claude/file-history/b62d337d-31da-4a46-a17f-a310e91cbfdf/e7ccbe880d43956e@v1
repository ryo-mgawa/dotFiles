# 縦画面表示システム 要件定義書

## 1. 概要

### 1.1 目的
縦向きに設置したディスプレイおよびカメラを使用し、ビデオ通話アプリケーションを縦画面で運用する。

### 1.2 基本方針
- **映像データの送受信は横向き（標準形式）のまま行う**
- **表示時のみ90度回転処理を適用する**
- 映像データ自体の加工は行わない

---

## 2. システム構成

### 2.1 ハードウェア構成

| 機器 | 設置方向 | 備考 |
|------|----------|------|
| ディスプレイ | 縦向き（90度回転） | 物理的に回転設置 |
| カメラ | 縦向き（90度回転） | 物理的に回転設置 |
| PC | - | Windows使用 |

### 2.2 OS設定

| 項目 | 設定値 |
|------|--------|
| 画面の向き | 縦（ポートレート） |
| 解像度 | 縦長解像度（例: 1080x1920） |

### 2.3 ソフトウェア構成

| 項目 | 技術 |
|------|------|
| フレームワーク | React |
| ビデオSDK | Zoom Video SDK Web |
| スタイリング | CSS（transform使用） |

---

## 3. 映像仕様

### 3.1 送信映像

| 項目 | 仕様 |
|------|------|
| データ形式 | 横向き（カメラ出力そのまま） |
| アスペクト比 | 16:9 または 4:3（カメラ依存） |
| 回転処理 | なし |
| 備考 | 受信側には横向き映像として届く |

### 3.2 受信映像

| 項目 | 仕様 |
|------|------|
| データ形式 | 横向き（送信元から受信したまま） |
| 回転処理 | なし（表示時に処理） |

### 3.3 表示映像

| 項目 | 仕様 |
|------|------|
| 回転角度 | 90度（時計回り） |
| 回転方式 | CSS transform による表示回転 |
| 適用対象 | ローカル映像、リモート映像の両方 |
| 処理タイミング | レンダリング時（表示のみ） |

---

## 4. UI仕様

### 4.1 レイアウト方針

- 縦長画面を前提としたUIデザイン
- コントロールボタンは画面下部に配置
- ヘッダー情報は画面上部に配置

### 4.2 画面構成

```
┌─────────────────┐
│     ヘッダー      │  ← 通話情報、ステータス
├─────────────────┤
│                 │
│                 │
│   メイン映像     │  ← 相手の映像（90度回転表示）
│    エリア        │
│                 │
│                 │
│    ┌─────┐      │
│    │自分 │      │  ← 自分の映像（小）（90度回転表示）
│    └─────┘      │
├─────────────────┤
│  コントロール     │  ← マイク、カメラ、終了ボタン
└─────────────────┘
```

### 4.3 自映像（セルフビュー）

| 項目 | 仕様 |
|------|------|
| 表示位置 | 画面右上または右下（オーバーレイ） |
| 表示サイズ | 小サイズ（PIP形式） |
| ミラー表示 | あり（左右反転） |
| 回転 | 90度 |

---

## 5. 制約事項

### 5.1 相手側への影響

| 項目 | 内容 |
|------|------|
| 相手が受信する映像 | 横向き（90度傾いた状態で見える） |
| 対応方法 | 相手側も同様の回転表示を実装するか、映像が傾いていることを許容する |

### 5.2 技術的制約

| 項目 | 内容 |
|------|------|
| 映像データの加工 | 行わない（CPU負荷軽減のため） |
| ビデオプロセッサ | 使用しない |
| 映像品質 | カメラ出力そのまま（劣化なし） |

### 5.3 運用上の注意点

1. **双方が同じシステムを使用する場合**
   - 両者とも回転表示を適用することで、正しい向きで表示される

2. **相手が通常のZoomクライアントを使用する場合**
   - 相手には横向き（90度傾いた）映像が表示される
   - 事前の説明または相手側での対応が必要

---

## 6. 実装要件

### 6.1 CSS回転処理

| 要素 | 回転処理 |
|------|----------|
| リモート映像 | transform: rotate(90deg) |
| ローカル映像 | transform: rotate(90deg) scaleX(-1) ※ミラー含む |
| UIコンポーネント | 回転なし（縦画面用にデザイン） |

### 6.2 サイズ調整

- 回転後は幅と高さが入れ替わるため、適切なサイズ計算が必要
- object-fit: cover または contain で表示領域に収める

### 6.3 座標系

- クリックイベント等の座標は回転後の座標系で処理
- 必要に応じて座標変換を実装

---

## 7. 将来的な拡張可能性

### 7.1 送信映像の回転対応

必要に応じて、以下の方式で送信映像も縦向きにすることが可能：

- Zoom Video SDK のビデオプロセッサ機能を使用
- Canvas API で映像を回転処理してから送信
- CPU負荷が増加するため、要検討

### 7.2 設定オプション

将来的に以下のオプションを追加可能：

- 回転角度の選択（0度/90度/180度/270度）
- 回転の有効/無効切り替え
- ミラー表示の有効/無効切り替え

---

## 8. 用語定義

| 用語 | 定義 |
|------|------|
| 横向き映像 | アスペクト比が横長の映像（16:9等）。通常のカメラ出力形式 |
| 縦向き映像 | アスペクト比が縦長の映像（9:16等） |
| 表示回転 | 映像データは変更せず、CSSで表示時のみ回転させる方式 |
| データ回転 | 映像データ自体を加工して回転させる方式（本システムでは採用しない） |
| PIP | Picture in Picture。小窓での映像表示 |

---

## 改訂履歴

| 版 | 日付 | 内容 |
|----|------|------|
| 1.0 | 2025-12-08 | 初版作成 |
