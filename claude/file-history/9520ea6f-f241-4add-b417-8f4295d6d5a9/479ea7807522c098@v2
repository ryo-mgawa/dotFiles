import { useEffect, useState } from 'react';
import { Container } from 'react-bootstrap';
import { AdvisorList } from '@/components/advisors/AdvisorList';
import { LoadingSpinner } from '@/components/common/LoadingSpinner';
import { ErrorMessage } from '@/components/common/ErrorMessage';
import { getAdvisors } from '@/services/api/advisorsApi';
import { Advisor } from '@/types/models/Advisor';

/**
 * 顧問名簿ページ
 * requirements.md 2.3節を参照
 */
export const AdvisorsPage = () => {
  const [advisors, setAdvisors] = useState<Advisor[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const fetchData = async () => {
      try {
        const data = await getAdvisors();
        setAdvisors(data);
      } catch (err) {
        setError('顧問情報の取得に失敗しました');
        console.error(err);
      } finally {
        setLoading(false);
      }
    };

    void fetchData();
  }, []);

  if (loading) return <LoadingSpinner />;
  if (error) return <ErrorMessage message={error} />;

  return (
    <Container>
      <h2 className="mb-4">顧問名簿</h2>
      <AdvisorList advisors={advisors} />
    </Container>
  );
};
