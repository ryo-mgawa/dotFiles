# 豊田高専陸上部ホームページ 要件定義書

## 1. プロジェクト概要
豊田高専陸上部の公式ホームページを構築する。
部員情報、大会結果、記録管理を行い、部活動の活性化と情報発信を目的とする。

## 2. 機能要件

### 2.1 トップページ

#### 2.1.1 グローバルヘッダー
各ページへのナビゲーションを提供する。

**ナビゲーション項目:**
- 部員名簿
- 大会結果
- 陸上部歴代記録
- 個人の歴代記録

#### 2.1.2 活動写真スライドショー
- **写真枚数:** 5枚
- **コンテンツ管理:** microCMSを使用
- **更新性:** 管理画面から簡単に写真を差し替え可能

#### 2.1.3 最新情報
- **表示内容:** X(旧Twitter)の埋め込み
- **目的:** 最新の活動情報をリアルタイムで発信

#### 2.1.4 活動時間
- **表示形式:** 表形式
- **表示内容:** 曜日別の練習時間

### 2.2 部員名簿ページ

#### 2.2.1 表示項目
- 学年
- 学科
- 名前
- 所属ブロック（短距離、中長距離、跳躍、投擲）

#### 2.2.2 ソート順
1. **第1優先:** 学年（5年 → 4年 → 3年 → 2年 → 1年）
2. **第2優先:** 学科（M科 → E科 → I科 → C科 → A科）
3. **第3優先:** 名前（五十音順）

### 2.3 大会結果ページ

#### 2.3.1 年度選択機能
- **UI:** プルダウン形式の年度選択フォーム
- **動作:** 年度選択により該当年度の大会一覧を表示

#### 2.3.2 大会一覧
- **表示順:** 新しい順（降順）
- **初期状態:** 大会名のみ表示（詳細は折りたたみ）
- **展開動作:** 大会名クリックで詳細を展開

#### 2.3.3 大会詳細情報
**表示項目:**
- 開催場所
- 開催日付
- 大会結果表（男子・女子で分離）

**結果表の項目:**
- 種目名
- 名前
- 学年
- 学科
- 記録
- 風速
- 備考

### 2.4 陸上部歴代記録ページ

#### 2.4.1 表示内容
- 各種目の上位10記録を表示
- 全大会結果から集計

#### 2.4.2 記録表の項目
- 順位
- 名前
- 学年
- 学科
- 記録
- 場所
- 日付

#### 2.4.3 種目一覧（想定）
**男子:**
- 短距離: 100m、200m、400m
- 中距離: 800m、1500m
- 長距離: 5000m、10000m
- ハードル: 110mH、400mH
- リレー: 4×100mR、4×400mR
- 跳躍: 走高跳、棒高跳、走幅跳、三段跳
- 投擲: 砲丸投、円盤投、ハンマー投、やり投

**女子:**
- 短距離: 100m、200m、400m
- 中距離: 800m、1500m
- 長距離: 3000m、5000m
- ハードル: 100mH、400mH
- リレー: 4×100mR、4×400mR
- 跳躍: 走高跳、棒高跳、走幅跳、三段跳
- 投擲: 砲丸投、円盤投、ハンマー投、やり投

### 2.5 個人の歴代記録ページ

#### 2.5.1 認証機能
- **入力項目:** 個人番号（学校発行）
- **目的:** 外部からの不正閲覧防止
- **認証方法:** 個人番号によるアクセス制御

#### 2.5.2 表示内容
- 入力された個人番号に対応する選手の全記録
- 種目別の記録推移
- ベスト記録

## 3. 非機能要件

### 3.1 アーキテクチャ要件
- **Clean Architecture** の採用
  - レイヤー分離による保守性の向上
  - ビジネスロジックとフレームワークの分離
- **TDD（テスト駆動開発）** の実践（t-wada準拠）
  - ユニットテストの完全なカバレッジ
  - テストファーストの開発プロセス
- **「良いコード/悪いコード」の原則** に基づく実装
  - 可読性と保守性を重視したコード設計

### 3.2 コーディング規約

#### 3.2.1 制御フロー
- **アーリーリターンの積極活用**
  - ネストを深くしない
  - 条件分岐では早期リターンを使用
  - ガード句の活用

```typescript
// Good
function processUser(user: User | null): string {
  if (!user) return "ユーザーが見つかりません";
  if (!user.isActive) return "ユーザーが無効です";
  return user.name;
}

// Bad
function processUser(user: User | null): string {
  if (user) {
    if (user.isActive) {
      return user.name;
    } else {
      return "ユーザーが無効です";
    }
  } else {
    return "ユーザーが見つかりません";
  }
}
```

#### 3.2.2 定数管理
- **マジックナンバー・ハードコーディングの禁止**
  - 数値は定数として定義
  - 文字列リテラルは定数として管理
  - 設定値は環境変数または設定ファイルで管理

```typescript
// Good
const MAX_RECORDS = 10;
const DEPARTMENTS = ['M', 'E', 'I', 'C', 'A'] as const;

// Bad
if (records.length > 10) { ... }
```

#### 3.2.3 型安全性
- **TypeScriptのany型の使用禁止**
- **適切な型定義の必須化**
- **unknown型の適切な活用**

```typescript
// Good
type Record = {
  event: string;
  time: number;
};

// Bad
let record: any = { ... };
```

#### 3.2.4 関数・メソッドの設計原則
- **単一責任の原則（SRP）の徹底**
- **純粋関数の活用**（副作用の最小化）
- **関数は20行以内を目安とする**
- **引数は3つ以内を推奨**

#### 3.2.5 エラーハンドリング
- 例外は適切にキャッチし、適切なエラーメッセージを提供
- try-catch文の適切な使用
- カスタム例外クラスの活用

```typescript
class RecordNotFoundError extends Error {
  constructor(recordId: string) {
    super(`記録が見つかりません: ${recordId}`);
    this.name = 'RecordNotFoundError';
  }
}
```

#### 3.2.6 パフォーマンス考慮
- 不要な再レンダリングの防止（React.memo、useMemo活用）
- データベースクエリの最適化
- 適切なインデックス活用

#### 3.2.7 可読性・保守性
- 自己文書化コードの作成
- 意図が伝わる変数名・関数名の使用
- 複雑なロジックには適切なコメント
- デッドコードの除去

### 3.3 技術要件

#### 3.3.1 フロントエンド
- **フレームワーク:** React 18+ + TypeScript
- **UIライブラリ:** React Bootstrap 5
- **カレンダーUI:** react-big-calendar（活動予定表示用）
- **ルーティング:** React Router（SPA対応）
- **状態管理:** Context API + useReducer
- **配置ディレクトリ:** `front/`

#### 3.3.2 バックエンド
- **ランタイム:** Node.js
- **フレームワーク:** Express + TypeScript
- **アーキテクチャ:** Clean Architecture適用
- **ORM:** Prisma
- **セキュリティ:** CORS・Helmet による対策
- **配置ディレクトリ:** `server/`

#### 3.3.3 コンテンツ管理
- **CMS:** microCMS
  - トップページの活動写真管理
  - 簡易的なコンテンツ更新

#### 3.3.4 データベース
- **サービス:** Supabase（PostgreSQL）
- **設計方針:**
  - 論理削除の実装
  - 適切なインデックス設計
  - データ整合性制約の設定

### 3.4 品質要件

#### 3.4.1 可用性
- 通常時間帯での安定稼働
- エラー発生時の適切なエラーメッセージ表示

#### 3.4.2 レスポンシブ対応
- PC・タブレット・スマートフォンでの最適表示
- ブレークポイントの適切な設定

#### 3.4.3 データ整合性
- 記録データの正確性保証
- トランザクション管理の徹底

#### 3.4.4 将来拡張性
- ログイン機能の追加を考慮
- 新機能追加時の影響範囲を最小化
- モジュール間の疎結合化

### 3.5 セキュリティ要件
- 個人番号による認証（個人記録閲覧時）
- SQLインジェクション対策
- XSS対策
- CSRF対策
- 適切なCORS設定

## 4. データモデル（想定）

### 4.1 主要エンティティ

#### Members（部員）
- id
- studentNumber（個人番号）
- name（名前）
- grade（学年: 1-5）
- department（学科: M/E/I/C/A）
- block（ブロック: 短距離/中長距離/跳躍/投擲）
- isActive（在籍フラグ）

#### Competitions（大会）
- id
- name（大会名）
- location（開催場所）
- date（開催日）
- year（年度）

#### Records（記録）
- id
- competitionId（大会ID）
- memberId（部員ID）
- event（種目）
- gender（性別）
- result（記録）
- wind（風速）
- note（備考）

#### Activities（活動情報）
- id
- dayOfWeek（曜日）
- startTime（開始時間）
- endTime（終了時間）

## 5. 画面遷移図（概要）

```
トップページ
├── 部員名簿
├── 大会結果
│   └── 大会詳細（年度選択 → 大会選択）
├── 陸上部歴代記録
└── 個人の歴代記録（認証必須）
```

## 6. 開発環境

### 6.1 推奨環境
- Node.js: v18以上
- npm/yarn
- TypeScript: v5以上

### 6.2 開発ツール
- ESLint: コード品質チェック
- Prettier: コードフォーマット
- Jest: テストフレームワーク
- React Testing Library: Reactコンポーネントテスト

## 7. 納品物
- ソースコード（`front/`、`server/`）
- データベーススキーマ
- README.md（セットアップ手順）
- テストコード
- API仕様書

## 8. 制約事項
- 個人情報保護法への準拠
- 学校のセキュリティポリシーへの準拠
- 個人番号の適切な管理

## 9. 今後の拡張可能性
- 管理者ログイン機能
- 記録データの一括インポート機能
- 記録のグラフ表示機能
- 練習メニュー管理機能
- 部員間のコミュニケーション機能
