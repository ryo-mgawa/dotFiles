import { Inject, Injectable } from '@nestjs/common';
import { ShipmentRepository } from '../../../data/repository/shipmentRepository';
import { AddShipmentsPresenterInterface } from '../../../interface/presenter/addShipmentsPresenterInterface';
import { Input } from './types';

@Injectable()
export class AddShipmentsUseCase {
  constructor(
    @Inject('AddShipmentsPresenter')
    private readonly presenter: AddShipmentsPresenterInterface,
    private readonly shipmentRepository: ShipmentRepository,
  ) { }

  public async execute(input: Input, organizationId: string): Promise<void> {
    try {
      console.log('[AddShipmentsUseCase] Starting execution', { organizationId, shipmentCount: input.shipments.length });
      const shipmentIds = await this.shipmentRepository.save(organizationId, input.shipments);
      console.log('[AddShipmentsUseCase] Shipments saved successfully', { shipmentIds });

      this.presenter.output(shipmentIds);
    } catch (error) {
      console.error('[AddShipmentsUseCase] Error occurred:', error);
      throw error;
    }
  }
}
